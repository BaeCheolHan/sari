# ğŸ§™â€â™‚ï¸ Sari (ì‚¬ë¦¬)

> **"ì ì‹œ ë‚´ ë§ ì¢€ ë“¤ì–´ë³´ê²Œë‚˜... ìë„¤ì˜ ì†ŒìŠ¤ì½”ë“œê°€ ì§€ì˜¥ì˜ ë¹„ëª…ì„ ì§€ë¥´ëŠ” ì†Œë¦¬ë¥¼!"** (Stay awhile and listen...)

**ì‚¬ë¦¬(Sari)**ëŠ” ì¸ê³µì§€ëŠ¥(AI) ì¹œêµ¬ë“¤ì´ ì—¬ëŸ¬ë¶„ì˜ ë³µì¡í•˜ê³  ê±°ëŒ€í•œ ì½”ë“œë¥¼ ì•„ì£¼ ì‰½ê³  ë¹ ë¥´ê²Œ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” **'í˜¸ë¼ë“œë¦¼ì˜ ìˆ˜ì„ ê¸°ë¡ê´€'**ì´ì—ìš”.

ì‚¬ë¦¬ ì„ ìƒë‹˜ë§Œ ê³„ì‹œë©´ ì•„ë¬´ë¦¬ ì–½íˆê³ ì„¤í‚¨ ì½”ë“œë¼ë„ AIê°€ ê¸¸ì„ ìƒì§€ ì•Šê³  í•„ìš”í•œ í´ë˜ìŠ¤ë¥¼ 0.1ì´ˆ ë§Œì— ì°¾ì•„ë‚¼ ìˆ˜ ìˆë‹µë‹ˆë‹¤.  
í˜¸ë¼ë“œë¦¼ì˜ ì´›ë¶ˆì´ êº¼ì§€ì§€ ì•ŠëŠ” í•œ, ì¸ë±ì‹± ëˆ„ë½ì´ë¼ëŠ” í˜¼ëˆì˜ ë¹„ëª…ì€ ë“¤ë¦¬ì§€ ì•Šê²Œ ë  ê±°ì˜ˆìš”. ğŸš€ (ì„ ìƒë‹˜ì´ ì§€íŒ¡ì´ë¡œ ê¸¸ì„ ì•„ì£¼ ìƒì„¸íˆ ì•ˆë‚´í•´ì£¼ì‹ ë‹µë‹ˆë‹¤.)

---

## ğŸ§ ì‚¬ë¦¬ ì„ ìƒë‹˜ì€ ëˆ„êµ¬ì¸ê°€ìš”? (ì‰½ê²Œ ì´í•´í•˜ê¸°)

ì—¬ëŸ¬ë¶„ì˜ ì»´í“¨í„°ì—ëŠ” ì•„ì£¼ ë§ì€ ì½”ë“œ íŒŒì¼ì´ ìˆì–´ìš”. ë˜‘ë˜‘í•œ **AI ì¹œêµ¬(Codex, Claude, Cursor, Gemini ë“±)**ì—ê²Œ ì½”ë“œë¥¼ ì§œë‹¬ë¼ê³  í•˜ë©´ ê°€ë” ì´ëŸ° ë§ì„ í•  ê±°ì˜ˆìš”.
*"ë¯¸ì•ˆí•´, íŒŒì¼ì´ ë„ˆë¬´ ë§ì•„ì„œ ì–´ë””ì— ë­ê°€ ìˆëŠ”ì§€ ëª¨ë¥´ê² ì–´!"*

ê·¸ë•Œ ë°”ë¡œ **ì‚¬ë¦¬ ì„ ìƒë‹˜**ì´ íŠ¸ë¦¬ìŠ¤íŠ¸ëŸ¼ ì–´ë”˜ê°€ì—ì„œ ë§ˆë²•ì²˜ëŸ¼ ë‚˜íƒ€ë‚©ë‹ˆë‹¤!

1.  **ì§€ë…í•œ ì‚¬ì„œ**: ì‚¬ë¦¬ ì„ ìƒë‹˜ì€ ì—¬ëŸ¬ë¶„ì˜ ëª¨ë“  ì½”ë“œë¥¼ ë¯¸ë¦¬ ë‹¤ ì½ì–´ë‘ê³ , ëˆ„ê°€ ì–´ëŠ ì§€ì˜¥ êµ¬ì„ì— ì‚¬ëŠ”ì§€(ì–´ë–¤ í•¨ìˆ˜ê°€ ì–´ë–¤ íŒŒì¼ì— ìˆëŠ”ì§€) ì•„ì£¼ ìƒì„¸í•œ **'í˜¸ë¼ë“œë¦¼ ì¥ë¶€'**ë¥¼ ë§Œë“¤ì–´ë‘¬ìš”. (ëˆˆì´ ì¹¨ì¹¨í•˜ì…”ë„ ì •ê·œì‹ì€ ê¸°ê°€ ë§‰íˆê²Œ ë³´ì‹­ë‹ˆë‹¤.)
2.  **AIì˜ ê¸¸ì¡ì´**: AI ì¹œêµ¬ê°€ "ì´ í”„ë¡œì íŠ¸ì—ì„œ íšŒì›ê°€ì…ì€ ì–´ë–»ê²Œ í•´?"ë¼ê³  ë¬¼ì–´ë³´ë©´, ì‚¬ë¦¬ ì„ ìƒë‹˜ì´ ì§€íŒ¡ì´ë¥¼ ì§šê³  ì¥ë¶€ë¥¼ ìŠ¥ ë³´ê³ ëŠ” "3ë²ˆ ì„ ë°˜ ì•„ë˜, ë””ì•„ë¸”ë¡œì˜ ê¼¬ë¦¬ ì˜†ì— ìˆëŠ” `user.py` íŒŒì¼ì„ ë³´ê²Œë‚˜! ì£¼ì„ ì¢€ ë˜‘ë°”ë¡œ ë‹¬ì§€ ê·¸ë¬ë‚˜..."ë¼ê³  ê¾¸ì§–ìœ¼ë©° ì•Œë ¤ì¤ë‹ˆë‹¤.
3.  **MCP(Model Context Protocol)**: ì´ê±´ AI ì¹œêµ¬ì™€ ì‚¬ë¦¬ ì„ ìƒë‹˜ì´ ì„œë¡œ ëŒ€í™”í•  ë•Œ ì“°ëŠ” **'í˜¸ë¼ë“œë¦¼ í†µì—­ê¸°'** ê°™ì€ ê±°ì˜ˆìš”. ì´ í†µì—­ê¸° ë•ë¶„ì— ì‚¬ë¦¬ ì„ ìƒë‹˜ì€ ì„¸ìƒì˜ ëª¨ë“  ìµœì‹  AIì™€ ëŒ€í™”í•  ìˆ˜ ìˆë‹µë‹ˆë‹¤! (ê³ ëŒ€ì–´ëŠ” ëª°ë¼ë„ Pythonì€ ê¿°ê³  ê³„ì‹œì£ .) ğŸ¤

---

## ğŸŒŸ ì‚¬ë¦¬ ì„ ìƒë‹˜ì˜ íŠ¹ë³„í•œ ëŠ¥ë ¥

- **âš¡ ì°¨ì›ë¬¸ ê²€ìƒ‰**: ìˆ˜ë§Œ ì¤„ì˜ ì½”ë“œë„ ìˆœì‹ê°„ì— ì½ì–´ì„œ í•„ìš”í•œ ë¶€ë¶„ë§Œ ê³¨ë¼ë‚´ìš”. (TP íƒ€ëŠ” ì†ë„ë³´ë‹¤ ë¹ ë¦…ë‹ˆë‹¤.)
- **ğŸ§  ì½”ë“œ ì‹¬ë ¹ìˆ **: ë‹¨ìˆœíˆ ê¸€ìë§Œ ì°¾ëŠ” ê²Œ ì•„ë‹ˆë¼, ì´ê²Œ 'í•¨ìˆ˜'ì¸ì§€ 'í´ë˜ìŠ¤'ì¸ì§€ ì½”ë“œì˜ ì˜í˜¼(AST)ì„ ì½ì–´ëƒ…ë‹ˆë‹¤.
- **ğŸ”’ ì² í†µ ë³´ì•ˆ**: ëª¨ë“  ê³µë¶€ëŠ” ì—¬ëŸ¬ë¶„ì˜ ì»´í“¨í„° ì•ˆì—ì„œë§Œ í•´ìš”. ì½”ë“œê°€ ì„±ì—­(ì¸í„°ë„·) ë°–ìœ¼ë¡œ ì ˆëŒ€ ë‚˜ê°€ì§€ ì•Šìœ¼ë‹ˆ ì•ˆì‹¬í•˜ì„¸ìš”! ì§€ì˜¥ì˜ ì•…ë§ˆë„ ì—¬ëŸ¬ë¶„ì˜ ì†ŒìŠ¤ì½”ë“œëŠ” ëª» í›”ì³ê°‘ë‹ˆë‹¤. ğŸ›¡ï¸
- **ğŸ‘» íˆ¬ëª… ë§í† **: ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì¡°ìš©íˆ ì¼í•˜ë©° ì—¬ëŸ¬ë¶„ì´ ì½”ë“œë¥¼ ê³ ì¹  ë•Œë§ˆë‹¤ ì¥ë¶€ë¥¼ ì•Œì•„ì„œ ì—…ë°ì´íŠ¸í•´ìš”. (ê°€ë” ê³„ì‹ ì§€ í™•ì¸í•˜ì§€ ì•Šìœ¼ë©´ ì„­ì„­í•´í•˜ì‹­ë‹ˆë‹¤.)

---

## ğŸš€ ì„±ì—­ ì†Œí™˜ ì£¼ë¬¸ (ì„¤ì¹˜ ë°©ë²• - Installation)

> **ì¤‘ìš”:** `deckard` ëª¨ë“ˆ/ì—”íŠ¸ë¦¬í¬ì¸íŠ¸ëŠ” **í˜¸í™˜ìš©ìœ¼ë¡œë§Œ ìœ ì§€**ë©ë‹ˆë‹¤.  
> ì•ìœ¼ë¡œëŠ” **Sari ì´ë¦„ì„ ì‚¬ìš©**í•´ ì£¼ì„¸ìš”. (í–¥í›„ ë²„ì „ì—ì„œ ì œê±° ì˜ˆì •)
>
> **ê°œë°œì ì°¸ê³ :** ë‚´ë¶€ ëª¨ë“ˆì€ `sari.core`, `sari.mcp` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ì œê³µë©ë‹ˆë‹¤.  
> ì¶©ëŒ ë°©ì§€ë¥¼ ìœ„í•´ `app`, `mcp` ê°™ì€ ìµœìƒìœ„ íŒ¨í‚¤ì§€ëŠ” ë°°í¬ë³¸ì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì„¤ì¹˜ ë°©ì‹ì€ ë‘ ê°€ì§€ì…ë‹ˆë‹¤.

1) **ì„¤ì •ë§Œ ì¶”ê°€í•˜ë©´ ìë™ ì„¤ì¹˜ (ê¶Œì¥)**  
2) **ì§ì ‘ ì„¤ì¹˜ (ì˜¤í”„ë¼ì¸/ì œí•œ í™˜ê²½ìš©)**

**ì„¤ì¹˜ ì•ˆì •ì„± ê¸°ì¤€ (KPI)**
1. ì˜¤í”„ë¼ì¸/ë¡œì»¬ ì†ŒìŠ¤/ë‹¤ë¥¸ workspace ì¬í˜„ ì„±ê³µë¥ : 3/3

**ìë™ ì„¤ì¹˜ ì¡°ê±´ ìš”ì•½**
- `DECKARD_ENGINE_MODE=embedded` + `DECKARD_ENGINE_AUTO_INSTALL=1` + ë„¤íŠ¸ì›Œí¬/pip ê°€ëŠ¥

### âœ… 1) ì„¤ì •ë§Œ ì¶”ê°€í•˜ë©´ ìë™ ì„¤ì¹˜ (ê¶Œì¥)
MCP ì„¤ì • íŒŒì¼ì— ì•„ë˜ ë¸”ë¡ì„ **ì§ì ‘ ì¶”ê°€**í•˜ë©´, ì‹¤í–‰ ì‹œ Sariê°€ ìë™ ì„¤ì¹˜ë©ë‹ˆë‹¤.
(ë„¤íŠ¸ì›Œí¬ê°€ ì—†ìœ¼ë©´ ê¸°ì¡´ ì„¤ì¹˜ëœ ë²„ì „ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.)

**macOS / Linux (Bash)**
```toml
[mcp_servers.sari]
command = "bash"
args = ["-lc", "export PATH=$PATH:/usr/local/bin:/opt/homebrew/bin:$HOME/.local/bin && (curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - -y || true) && exec ~/.local/share/sari/bootstrap.sh --transport stdio"]
env = { DECKARD_WORKSPACE_ROOT = "/path/to/workspace", DECKARD_RESPONSE_COMPACT = "1" }
startup_timeout_sec = 60
```

**Windows (PowerShell)**
```toml
[mcp_servers.sari]
command = "powershell"
args = ["-NoProfile", "-ExecutionPolicy", "Bypass", "-Command", "irm https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python - -y; & $env:LOCALAPPDATA\\sari\\bootstrap.bat --transport stdio"]
env = { DECKARD_WORKSPACE_ROOT = "C:\\path\\to\\workspace", DECKARD_RESPONSE_COMPACT = "1" }
startup_timeout_sec = 60
```

---

## ğŸ§© ì„¤ì •/ì„¤ì¹˜ ìƒì„¸ ê°€ì´ë“œ (ì´ˆë³´ììš© / ê³ ê¸‰ììš©)

### âœ… ì´ˆë³´ììš© (ê¶Œì¥ ê²½ë¡œ)

#### 1) ì„¤ì¹˜ ë°©ì‹ ì„ íƒ ê°€ì´ë“œ
**A. ì„¤ì •ë§Œ ì¶”ê°€(ê¶Œì¥)**  
MCP ì„¤ì •ì— `bootstrap.sh` ì‹¤í–‰ ë¸”ë¡ì„ ì¶”ê°€í•˜ë©´, ì‹¤í–‰ ì‹œ ìë™ ì„¤ì¹˜ë©ë‹ˆë‹¤.

**B. ì˜¤í”„ë¼ì¸/ê³ ì • ì„¤ì¹˜**  
ë„¤íŠ¸ì›Œí¬ê°€ ë¶ˆê°€í•œ í™˜ê²½ì´ë©´ **ì´ë¯¸ ì„¤ì¹˜ëœ `bootstrap.sh` ê²½ë¡œ**ë¥¼ ì§ì ‘ ì§€ì •í•˜ì„¸ìš”.

**ë¡¤ë°±(SQLite) ê²½ê³ **  
SQLite ëª¨ë“œë¡œ ë¡¤ë°±í•œ ê²½ìš° **FTS ì¬ë¹Œë“œê°€ í•„ìš”**í•  ìˆ˜ ìˆìœ¼ë©°, ì™„ë£Œ ì „ê¹Œì§€ ê²€ìƒ‰ í’ˆì§ˆì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

#### 2) MCP ì„¤ì • íŒŒì¼ ìœ„ì¹˜ (ì•±ë³„)
**Codex / Gemini**  
`<workspace>/.codex/config.toml`

**Claude Desktop**  
`claude_desktop_config.json`

**Cursor**  
ì•± Settings > MCP ë©”ë‰´

---

#### 3) MCP ì„¤ì • í…œí”Œë¦¿ (TOML)
```toml
[mcp_servers.sari]
command = "bash"
args = ["-lc", "curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - -y; exec ~/.local/share/sari/bootstrap.sh --transport stdio"]
env = {
  DECKARD_WORKSPACE_ROOT = "/path/to/workspace",
  DECKARD_RESPONSE_COMPACT = "1",
  DECKARD_ENGINE_MODE = "embedded",
  DECKARD_ENGINE_TOKENIZER = "auto",
  DECKARD_ENGINE_AUTO_INSTALL = "1"
}
startup_timeout_sec = 60
```

---

#### 4) MCP ì„¤ì • í…œí”Œë¦¿ (JSON)
```json
{
  "mcpServers": {
    "sari": {
      "command": "bash",
      "args": [
        "-lc",
        "export PATH=$PATH:/usr/local/bin:/opt/homebrew/bin:$HOME/.local/bin && (curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - -y || true) && exec ~/.local/share/sari/bootstrap.sh --transport stdio"
      ],
      "env": {
        "DECKARD_WORKSPACE_ROOT": "/path/to/workspace",
        "DECKARD_RESPONSE_COMPACT": "1",
        "DECKARD_ENGINE_MODE": "embedded",
        "DECKARD_ENGINE_TOKENIZER": "auto",
        "DECKARD_ENGINE_AUTO_INSTALL": "1"
      },
      "startup_timeout_sec": 60
    }
  }
}
```

---

#### 5) env ì˜µì…˜ ì„¤ëª… (í•µì‹¬)
`DECKARD_WORKSPACE_ROOT`  
ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë£¨íŠ¸. ê°€ì¥ ì¤‘ìš”í•œ ì˜µì…˜.

`DECKARD_ENGINE_MODE`  
ì—”ì§„ ëª¨ë“œ ì„ íƒ. `embedded|sqlite` (ê¸°ë³¸: `embedded`)

`DECKARD_RESPONSE_COMPACT`  
PACK1 ì‘ë‹µ ì••ì¶•(ê¸°ë³¸ `1`).

`DECKARD_ENGINE_TOKENIZER`  
`auto|cjk|latin` ì„ íƒ.

`DECKARD_ENGINE_AUTO_INSTALL`  
`1`ì´ë©´ ì²« ê²€ìƒ‰/ì¬ë¹Œë“œ ì‹œ ì—”ì§„ ìë™ ì„¤ì¹˜.

`DECKARD_READ_MAX_BYTES`  
`read_file` ì‘ë‹µ ìµœëŒ€ ë°”ì´íŠ¸ ìˆ˜ ì œí•œ (ê¸°ë³¸: 1,048,576 bytes). í° íŒŒì¼ OOM ë°©ì§€ìš©.
`DECKARD_READ_POOL_MAX`  
read ì „ìš© ì»¤ë„¥ì…˜ í’€ ìƒí•œ (ê¸°ë³¸: 32). ì´ˆê³¼ ì‹œ ê¸°ë³¸ read ì»¤ë„¥ì…˜ì„ ê³µìœ .

---

#### 6) bootstrap.sh ë‹¨ë… ì‹¤í–‰ (CLI)
```bash
DECKARD_WORKSPACE_ROOT=/path/to/workspace \
DECKARD_ENGINE_MODE=embedded \
DECKARD_ENGINE_TOKENIZER=cjk \
DECKARD_ENGINE_AUTO_INSTALL=1 \
~/.local/share/sari/bootstrap.sh --transport stdio
```

---

#### 7) ì˜¤í”„ë¼ì¸/ê³ ì • ì„¤ì¹˜ ê²½ë¡œ
**macOS/Linux**  
`~/.local/share/sari/bootstrap.sh`

**Windows**  
`%LOCALAPPDATA%\\sari\\bootstrap.bat`

---

#### 8) ê°€ì¥ í”í•œ ì‹¤ìˆ˜
**workspace-root ë¯¸ì§€ì •**  
í™ˆ ë””ë ‰í† ë¦¬ ì „ì²´ê°€ ì¸ë±ì‹±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ ì§€ì •í•˜ì„¸ìš”.

**args/env ë¶ˆì¼ì¹˜**  
envê°€ ìš°ì„  ì ìš©ë˜ë¯€ë¡œ ë‘˜ì„ ë™ì¼í•˜ê²Œ ë§ì¶”ì„¸ìš”.

**ì„¤ì¹˜ë³¸/ë ˆí¬ ê²½ë¡œ í˜¼ìš©**  
í•˜ë‚˜ì˜ ê²½ë¡œë§Œ ì‚¬ìš©í•˜ì„¸ìš”.

---

### ğŸ›  ê³ ê¸‰ììš© (ì»¤ìŠ¤í„°ë§ˆì´ì§•)

#### 1) ì—”ì§„/í† í¬ë‚˜ì´ì € ê°•ì œ ì„¤ì •
```bash
export DECKARD_ENGINE_TOKENIZER=latin
export DECKARD_ENGINE_AUTO_INSTALL=0
export DECKARD_ENGINE_MODE=embedded
```

#### 2) ì‘ë‹µ í¬ë§· ë””ë²„ê¹…
```bash
export DECKARD_FORMAT=json
export DECKARD_RESPONSE_COMPACT=0
```

#### 3) ë£¨íŠ¸/í¬íŠ¸/DB ê²½ë¡œ ê³ ì •
```bash
export DECKARD_WORKSPACE_ROOT=/path/to/workspace
export DECKARD_HTTP_API_PORT=7331
export DECKARD_DB_PATH=/absolute/path/to/index.db
```

#### 4) ë©€í‹° ë£¨íŠ¸ (ê³ ê¸‰)
```bash
export DECKARD_ROOTS_JSON='["/path/a","/path/b"]'
```

#### 5) ì‹¤í–‰ ì˜ˆì‹œ (ë‹¨ì¼ ì»¤ë§¨ë“œ)
```bash
DECKARD_WORKSPACE_ROOT=/path/to/workspace \
DECKARD_ENGINE_MODE=embedded \
DECKARD_ENGINE_TOKENIZER=cjk \
DECKARD_ENGINE_AUTO_INSTALL=1 \
DECKARD_FORMAT=pack \
~/.local/share/sari/bootstrap.sh --transport stdio
```

#### 6) ë²ˆë“¤ í¬ê¸° ì¤„ì´ê¸° (ì˜µì…˜)
ì—”ì§„ í† í¬ë‚˜ì´ì € ì‚¬ì „ì€ OSë³„ wheelì´ í•¨ê»˜ í¬í•¨ë©ë‹ˆë‹¤.  
ë°°í¬ í¬ê¸°ë¥¼ ì¤„ì´ë ¤ë©´ í˜„ì¬ OSì— ë§ëŠ” ë²ˆë“¤ë§Œ ë‚¨ê¸°ì„¸ìš”.

```bash
./scripts/prune_tokenizer_bundles.sh
```

Windows:
```bat
scripts\prune_tokenizer_bundles.bat
```

### ğŸ”§ Engine/Tokenizer ì˜µì…˜ (envë¡œ ì£¼ì…)
`bootstrap.sh`ë¡œ í•œë°© ì„¤ì¹˜í•´ë„ **envëŠ” ê·¸ëŒ€ë¡œ ì ìš©**ë©ë‹ˆë‹¤.  
MCP ì„¤ì •ì˜ `env`ì— ì•„ë˜ ì˜µì…˜ì„ ì¶”ê°€í•˜ì„¸ìš”.

**ëª¨ë“œ ì°¨ì´ (Embedded vs SQLite)**
- `embedded`  
  - Tantivy ê¸°ë°˜ ì—”ì§„ ì‚¬ìš© (ê²€ìƒ‰ í’ˆì§ˆ/ì„±ëŠ¥ ìš°ì„ )  
  - ë³„ë„ ì—”ì§„ ì„¤ì¹˜ í•„ìš” (ìë™ ì„¤ì¹˜ ê°€ëŠ¥)  
  - CJK í˜•íƒœì†Œ ë¶„ì„ì€ **ë²ˆë“¤ëœ lindera(ipadic) ì‚¬ì „**ì„ ì‚¬ìš© (ì™¸ë¶€ ë‹¤ìš´ë¡œë“œ ì—†ìŒ)
  - ì¸ë±ìŠ¤ëŠ” `~/.local/share/sari/index/<roots_hash>`ì— ê´€ë¦¬
- `sqlite`  
  - SQLite FTS/LIKE ê¸°ë°˜ (í˜¸í™˜/ë¡¤ë°±ìš©)  
  - ì—”ì§„ ì„¤ì¹˜ ì—†ì´ ë™ì‘  
  - ëŒ€ìš©ëŸ‰/ê³ ì† ê²€ìƒ‰ ì„±ëŠ¥ì€ ì œí•œì 

**ìë™ ì„¤ì¹˜ ë™ì‘ ì¡°ê±´**
- `DECKARD_ENGINE_MODE=embedded`
- `DECKARD_ENGINE_AUTO_INSTALL=1`
- ë„¤íŠ¸ì›Œí¬ ê°€ëŠ¥ + `pip` ì„¤ì¹˜ ê°€ëŠ¥

**ìë™ ì„¤ì¹˜ ë¹„í™œì„±/ì‹¤íŒ¨ ì‹œ**
- ì˜¤í”„ë¼ì¸ í™˜ê²½ì´ê±°ë‚˜ `DECKARD_ENGINE_AUTO_INSTALL=0`ì¸ ê²½ìš° ìë™ ì„¤ì¹˜ê°€ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ìˆ˜ë™ ì„¤ì¹˜ ëª…ë ¹: `sari --cmd engine install`

**ì˜¤ë¥˜ ë©”ì‹œì§€/ë³µêµ¬ ì•ˆë‚´ (ê³ ì •)**
- ìë™ ì„¤ì¹˜ ì‹¤íŒ¨: `ERR_ENGINE_NOT_INSTALLED` â†’ `sari --cmd engine install`
- ì—”ì§„ ì¤€ë¹„ ì•ˆ ë¨: `ERR_ENGINE_UNAVAILABLE` â†’ `sari --cmd engine rebuild`

**ì£¼ìš” ì˜µì…˜**
- `DECKARD_ENGINE_MODE=embedded|sqlite`  
  - ê¸°ë³¸: `embedded`
  - `embedded`: Tantivy ê¸°ë°˜ ì—”ì§„
  - `sqlite`: SQLite ê²€ìƒ‰ ì—”ì§„(í˜¸í™˜/ë¡¤ë°±ìš©)
- `DECKARD_ENGINE_TOKENIZER=auto|cjk|latin`  
  - ê¸°ë³¸: `auto`
  - `cjk`: CJK í† í¬ë‚˜ì´ì € ê°•ì œ
  - `latin`: latin í† í¬ë‚˜ì´ì € ê°•ì œ
- `DECKARD_ENGINE_AUTO_INSTALL=1|0`  
  - `1`: ì²« ê²€ìƒ‰/ì¬ë¹Œë“œ ì‹œ ìë™ ì„¤ì¹˜
  - `0`: ìë™ ì„¤ì¹˜ ë¹„í™œì„± (ì˜¤í”„ë¼ì¸/ì œí•œ í™˜ê²½)
- `DECKARD_LINDERA_DICT_PATH=/path/to/dictionary`  
  - í˜•íƒœì†Œ ì‚¬ì „ ê²½ë¡œ ê°•ì œ ì§€ì • (í•„ìš” ì‹œ)
- `DECKARD_READ_MAX_BYTES=0|N`  
  - `read_file` ì‘ë‹µ í¬ê¸° ì œí•œ. `0`ì´ë©´ ì œí•œ ì—†ìŒ.  
  - ê¸°ë³¸: `1048576` (ì•½ 1MB)
- `DECKARD_READ_POOL_MAX=0|N`  
  - read ì „ìš© ì»¤ë„¥ì…˜ í’€ ìƒí•œ. `0`ì´ë©´ ì œí•œ ì—†ìŒ.  
  - ê¸°ë³¸: `32`

**ì˜ˆì‹œ**
```toml
env = {
  DECKARD_WORKSPACE_ROOT = "/path/to/workspace",
  DECKARD_RESPONSE_COMPACT = "1",
  DECKARD_ENGINE_MODE = "embedded",
  DECKARD_ENGINE_TOKENIZER = "cjk",
  DECKARD_ENGINE_AUTO_INSTALL = "1"
}
```

### ğŸ§° 2) ì§ì ‘ ì„¤ì¹˜ (ì˜¤í”„ë¼ì¸/ì œí•œ í™˜ê²½ìš©)
í„°ë¯¸ë„(Terminal)ì—ì„œ ì§ì ‘ ì„¤ì¹˜ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```bash
# macOS / Linux
curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - -y

# Windows (PowerShell)
irm https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python - -y
```

### ğŸ“– í˜¸ë¼ë“œë¦¼ì˜ ì„¤ì¹˜ ê³„ì‹œ (How it works)
ì‚¬ë¦¬ ì„ ìƒë‹˜ì˜ ì„¤ì¹˜ ë§ˆë²•ì€ ì´ë ‡ê²Œ ë™ì‘í•©ë‹ˆë‹¤:

1. **ì„¤ì •ë§Œ ì¶”ê°€** â†’ ì‹¤í–‰ ì‹œ ë„¤íŠ¸ì›Œí¬ì—ì„œ ìë™ ì„¤ì¹˜
2. ì„¤ì¹˜ ìœ„ì¹˜ëŠ” í•­ìƒ **ì „ì—­ ê³ ì •** (`~/.local/share/sari` / `%LOCALAPPDATA%\\sari`)
3. ë°ëª¬ì€ **í•­ìƒ í•˜ë‚˜**ë¡œ ìœ ì§€


### ì„¤ì¹˜í•˜ë©´ ì–´ë–¤ ë§ˆë²•ì´ ì¼ì–´ë‚˜ë‚˜ìš”?
1.  **ì§€í˜œ ì „ìˆ˜**: ì‚¬ë¦¬ ì„ ìƒë‹˜ì´ ì¼í•  ë•Œ í•„ìš”í•œ ìµœì†Œí•œì˜ ë„êµ¬(Python ì—”ì§„ ë“±)ë¥¼ ìë™ìœ¼ë¡œ ì¤€ë¹„í•©ë‹ˆë‹¤.
2.  **ë¹„ë°€ ê±°ì²˜ ë§ˆë ¨**: ë„ì„œê´€ ì£¼ì†Œë¥¼ ë§Œë“­ë‹ˆë‹¤. (ì´ì‚¬ ë¹„ìš©ì€ ë¬´ë£Œì…ë‹ˆë‹¤.)
    - **macOS/Linux**: `~/.local/share/sari` (ì‚¬ê³¼ ë§ˆí¬ê°€ ì°íŒ ë¹„ë°€ ì°½ê³ )
    - **Windows**: `%LOCALAPPDATA%\sari` (ì°½ë¬¸ì´ ë‹¬ë¦° ë¹„ë°€ ì°½ê³ )
3.  **í†µì—­ê¸° ì—°ê²°**: MCP ì„¤ì • ë¸”ë¡ë§Œ ì¶”ê°€í•˜ë©´ ì‹¤í–‰ ì‹œ ìë™ìœ¼ë¡œ ì—°ê²°ë©ë‹ˆë‹¤.

### ì„¤ì •ì€ ì–´ë””ì— ìˆ¨ê²¨ì§€ë‚˜ìš”? (ìˆ˜ë™ ë“±ë¡ ë°©ì‹)
**ì„¤ì • íŒŒì¼ì€ ìë™ìœ¼ë¡œ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**  
Codex/GeminiëŠ” TOML, Cursor/ClaudeëŠ” JSON í˜•ì‹ìœ¼ë¡œ ë™ì¼ ë‚´ìš©ì„ ë„£ì–´ì£¼ì„¸ìš”.

### ì—¬ëŸ¬ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë™ì‹œì—? (ë¶„ì‹ ìˆ ì˜ ëŒ€ê°€)
- **ì„¤ì •ì€ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë³„ë¡œ ê°ìì˜ ìš´ëª…**ì„ ê°€ì§‘ë‹ˆë‹¤.  
  ì˜ˆ: Aì—ì„œ ì‹¤í–‰ â†’ `A/.codex/config.toml` ìƒì„± (Aì˜ ê¸°ë¡)  
  Bì—ì„œ ì‹¤í–‰ â†’ `B/.codex/config.toml` ìƒì„± (Bì˜ ë°€ì„œ)
- **ëª¸ì€ í•˜ë‚˜, ì§€í˜œëŠ” ì—¬ëŸ¬ ê³³ì—**: ì‚¬ë¦¬ ì„ ìƒë‹˜ì€ í•˜ë‚˜ì˜ ë°ëª¬(Daemon)ìœ¼ë¡œ ë™ì‘í•˜ì§€ë§Œ, ì„±ì—­ ê³³ê³³ì— ë¶„ì‹ ì„ ë³´ë‚´ì–´ **Aì™€ B ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë™ì‹œì—** ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! (ì„ ìƒë‹˜ì´ ì›Œì»¤í™€ë¦­ì´ë¼ AB ë‘˜ ë‹¤ ì¼œë‘ë©´ ë‘˜ ë‹¤ ìƒ…ìƒ…ì´ ìˆ˜ì§‘í•˜ì‹ ë‹¤ë„¤.)
- **ì² ì €í•œ ê¸°ë¡ ë¶„ë¦¬**: Aì˜ ì¥ë¶€ì™€ Bì˜ ì¥ë¶€ëŠ” ì„œë¡œ ì„ì´ì§€ ì•Šë„ë¡ ì—„ê²©íˆ ë¶„ë¦¬ëœ ì„œë(Data Directory)ì— ë³´ê´€ë©ë‹ˆë‹¤. Aì—ì„œ ë””ì•„ë¸”ë¡œë¥¼ ê²€ìƒ‰í–ˆëŠ”ë° Bì˜ ë°”ì•Œì´ íŠ€ì–´ë‚˜ì˜¤ëŠ” ì¼ì€ ì—†ìœ¼ë‹ˆ ì•ˆì‹¬í•˜ì‹œê²Œë‚˜.

---

## ğŸª„ ì„¤ì¹˜ ì˜µì…˜ (ëŒ€ì•ˆ)

**ì˜¤í”„ë¼ì¸/ì œí•œ í™˜ê²½ìš©**  
ì„¤ì •ì—ì„œ `command`ë¥¼ ì„¤ì¹˜ë³¸ `bootstrap.sh`ë¡œ ì§ì ‘ ì§€ì •í•˜ë©´ ë„¤íŠ¸ì›Œí¬ ì—†ì´ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**bootstrap ìŠ¤í¬ë¦½íŠ¸ ìœ„ì¹˜**
- **macOS/Linux**: `~/.local/share/sari/bootstrap.sh`
- **Windows**: `%LOCALAPPDATA%\\sari\\bootstrap.bat`

---

## ğŸ§­ ì°¨ì›ë¬¸ ì—°ê²° ìœ„ì¹˜ì™€ ë™ì‘ (ì‹¤í–‰ ìœ„ì¹˜ ìš”ì•½)
| ì‹¤í–‰ ìœ„ì¹˜ (ì°¨ì›ë¬¸ ì£¼ì†Œ) | workspace-rootê°€ ì—†ì„ ë•Œ ìš´ëª… |
|---|---|
| ë ˆí¬ ë‚´ë¶€ | ë ˆí¬ ë˜ëŠ” ìƒìœ„ `.codex-root`ë¥¼ ê³ í–¥ìœ¼ë¡œ ì¸ì‹ |
| ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë£¨íŠ¸ | "ì—¬ê¸°ê°€ ë‚´ ì§‘ì´êµ¬ë‚˜!" í•˜ê³  ë°”ë¡œ ì •ì°© |
| í™ˆ ë””ë ‰í† ë¦¬ (`~`) | ì—¬ëŸ¬ë¶„ì˜ ì˜¨ ì§‘ì•ˆ ì‚´ë¦¼ì„ ë‹¤ ë’¤ì§‘ì–´ ë´„ (ê°•ë ¥íˆ ë¹„ì¶”ì²œ!) |

---

## âš ï¸ "ì„±ìŠ¤ëŸ¬ìš´ í˜¼ìš©" ê¸ˆì§€ ê²½ê³ 
`command`ì— **ì„¤ì¹˜ë³¸ê³¼ ë ˆí¬ ê²½ë¡œë¥¼ ì„ì–´ ì“°ë©´** ì§€ì˜¥ë¬¸ì´ ì—´ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ì—…ë°ì´íŠ¸ ê·œì¹™ì´ ë’¤ì—‰ì¼œì„œ ê³ ëŒ€ ë²„ì „ì´ íŠ€ì–´ë‚˜ì˜¤ê±°ë‚˜,
- ì„œë¡œ ë‹¤ë¥¸ ë°ëª¬ì´ ë‚˜íƒ€ë‚˜ í¬íŠ¸ 47779ë¥¼ ë‘ê³  'ì„±ì „'ì„ ë²Œì´ê±°ë‚˜,
- "ì–´ëŠ ì„¤ì •ì´ ì§„ì§œì¸ê°€" í•˜ê³  ìì•„ ë¶„ì—´ì´ ì¼ì–´ë‚©ë‹ˆë‹¤.

ë”°ë¼ì„œ **configì—ëŠ” í•­ìƒ í•œ ê²½ë¡œë§Œ ìœ ì§€**í•˜ì„¸ìš”. (1â€‘Step ë˜ëŠ” ê³ ì • ëª¨ë“œ ì¤‘ í•˜ë‚˜!)

---

## ğŸ” ì„±ì—­ì˜ ìœ ì§€ë³´ìˆ˜ (Update & Recovery)

### ğŸ” ê°•ì œ ì—…ë°ì´íŠ¸ ë° ë³µêµ¬
ë§Œì•½ ì„¤ì¹˜ í´ë”ê°€ ì†ìƒë˜ì—ˆê±°ë‚˜, ìµœì‹  ë²„ì „ìœ¼ë¡œ ê°•ì œ ì¬ì„¤ì¹˜ê°€ í•„ìš”í•˜ë‹¤ë©´ `--update` í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.

```bash
# ì„¤ì¹˜ê°€ ê¼¬ì˜€ê±°ë‚˜ ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•  ë•Œ
curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - --update -y
```

### âœ… ìˆ˜ì„ ê¸°ë¡ê´€ì˜ ìµœì¢… ì ê²€ (Checklist)
ì„¤ì¹˜ í›„ ëª¨ë“  ê²ƒì´ ì •ìƒì¸ì§€ í™•ì¸í•˜ë ¤ë©´ **ë‹¥í„°(Doctor)**ë¥¼ ì†Œí™˜í•˜ì„¸ìš”:
```bash
python3 ~/.local/share/sari/doctor.py
```

### ğŸ§¹ ë„ì„œê´€ ëŒ€ì²­ì†Œ ë° ë³´ì•ˆ (Caution!)
- **ì¥ë¶€ì˜ ì†Œë©¸**: ì‚­ì œ ì‹œ ê³µë“¤ì—¬ ë§Œë“  ê¸°ë¡(DB)ë„ í•¨ê»˜ ê°€ë£¨ê°€ ë©ë‹ˆë‹¤ â†’ ì¬ì„¤ì¹˜ í›„ **ì¬ì¸ë±ì‹±ì´ë¼ëŠ” ì „ì„¤ê¸‰ ë…¸ê°€ë‹¤**ê°€ í•„ìš”í•©ë‹ˆë‹¤.
- **ìˆ˜í–‰ì˜ ì‹œê°„**: ì²« ì‹¤í–‰ ì‹œ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (í˜¸ë¼ë“œë¦¼ ë„ì„œê´€ 20,000í‰ì„ í˜¼ì ë¹—ì§ˆí•˜ì‹ ë‹¤ê³  ìƒê°í•´ë³´ì‹œê²Œë‚˜, ì§€ê·¹íˆ ì •ìƒì´ë¼ë„¤.)

### ğŸ”’ ì²œìƒì˜ ë³´ì•ˆ/í”„ë¼ì´ë²„ì‹œ
- ëª¨ë“  ê³µë¶€ì™€ ê²€ìƒ‰ì€ **ì—¬ëŸ¬ë¶„ì˜ ì•ˆë°©(ë¡œì»¬)**ì—ì„œë§Œ ìˆ˜í–‰ë©ë‹ˆë‹¤.
- ì½”ë“œê°€ ì§€ì˜¥(ì™¸ë¶€ ì„œë²„)ìœ¼ë¡œ ì „ì†¡ë˜ëŠ” ë¶ˆìƒì‚¬ëŠ” ê²°ì½” ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ë¡œê·¸ì™€ ìºì‹œëŠ” ì˜¤ì§ ì—¬ëŸ¬ë¶„ì˜ í•˜ë“œë””ìŠ¤í¬ ê¹Šìˆ™í•œ ê³³ì—ë§Œ ë´‰ì¸ë©ë‹ˆë‹¤. (ë””ì•„ë¸”ë¡œë„ ëª» í›”ì³ê°€ë„¤.)

### ğŸ§¼ Redaction (ë¯¼ê°ì •ë³´ ë§ˆìŠ¤í‚¹)
- ì¸ë±ì‹±/í…”ë ˆë©”íŠ¸ë¦¬ ë¡œê·¸ ê¸°ë¡ ì „ **ë¯¼ê°ì •ë³´ë¥¼ ë§ˆìŠ¤í‚¹**í•©ë‹ˆë‹¤.
- ê¸°ë³¸ê°’ì€ `redact_enabled=true`ì´ë©°, ì„¤ì •ì—ì„œ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë§ˆìŠ¤í‚¹ ë²”ìœ„/íŒ¨í„´ì€ `app/indexer.py`ì˜ `_redact` ë¡œì§ ê¸°ì¤€ì…ë‹ˆë‹¤.

---

## ğŸ§­ ë‹¤ì¤‘ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë˜‘ë˜‘í•˜ê²Œ ì“°ëŠ” ë°©ë²•
â€œAë„ ë³´ê³  ì‹¶ê³  Bë„ ë³´ê³  ì‹¶ì–´!â€ í•˜ì‹œëŠ” ë¶„ë“¤ì„ ìœ„í•œ **í˜„ì‹¤ì ì¸ ì¶”ì²œ íŒ¨í„´**ì´ì—ìš”.

- **ë°©ë²• 1: ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë³„ë¡œ ì„¤ì •ì„ ë‚˜ëˆ ë‘ê¸° (ê¶Œì¥)**  
  A, B ê°ê°ì— `.codex/config.toml`ì„ ë§Œë“¤ì–´ ë‘ê³ , í•„ìš”í•  ë•Œ ê·¸ í´ë”ì—ì„œ ì‹¤í–‰í•˜ì„¸ìš”.  
  ì‚¬ë¦¬ ì„ ìƒë‹˜ì€ **í˜„ì¬ ìœ„ì¹˜ ê¸°ì¤€**ìœ¼ë¡œ ì›€ì§ì´ëŠ” ì„±ê²©ì´ë¼, ê·¸ê²Œ ì œì¼ ëª…í™•í•©ë‹ˆë‹¤.

- **ë°©ë²• 2: í•˜ë‚˜ì˜ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë§Œ ì§‘ì¤‘ ê´€ë¦¬**  
  â€œì§€ê¸ˆì€ Aë§Œ ë´ì•¼ í•´!â€ë¼ë©´ BëŠ” ê³¼ê°í•˜ê²Œ ìŠìœ¼ì„¸ìš”.  
ì‚¬ë¦¬ëŠ” **í•œ ë²ˆì— í•˜ë‚˜ì— ì§‘ì¤‘í•˜ëŠ” ì„ ìƒë‹˜**ì´ì—ìš”. (ë©€í‹°íƒœìŠ¤í‚¹ì€ ë‹¤ìŒ í•™ê¸°ì—â€¦)

---

## ğŸ§¯ ë¬¸ì œ í•´ê²° (Troubleshooting)

### Q. MCP ì—°ê²°ì´ ì•ˆ ë¼ìš”
- `command`ê°€ `bash`ì¸ì§€, ê·¸ë¦¬ê³  ë„¤íŠ¸ì›Œí¬ê°€ í—ˆìš©ë˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
- ì œí•œ í™˜ê²½ì´ë¼ë©´ **ì„¤ì¹˜ë³¸ bootstrap ê²½ë¡œ**ë¡œ ì „í™˜í•˜ì„¸ìš”.
- ë°ëª¬ ìƒíƒœ í™•ì¸:
  ```bash
  # macOS/Linux
  ~/.local/share/sari/bootstrap.sh daemon status
  
  # Windows
  %LOCALAPPDATA%\sari\bootstrap.bat daemon status
  ```
- ê¸°ë™ì´ ëŠë¦¬ë©´ `startup_timeout_sec`ë¥¼ 120~180ìœ¼ë¡œ ì˜¬ë ¤ë³´ì„¸ìš”.

### Q. ì²« ì‹¤í–‰ì´ ë„ˆë¬´ ëŠë ¤ìš”
- ì²« ì¸ë±ì‹±ì€ ì›ë˜ ì‹œê°„ì´ ì¢€ ê±¸ë¦½ë‹ˆë‹¤. (í˜¸ë¼ë“œë¦¼ ë„ì„œê´€ 20,000í‰ì„ í˜¼ì ì²­ì†Œí•˜ì‹ ë‹¤ê³  ìƒê°í•´ë³´ì„¸ìš”.)
- `--workspace-root`ë¡œ ë²”ìœ„ë¥¼ ì¤„ì´ë©´ í›¨ì”¬ ë¹¨ë¼ì§‘ë‹ˆë‹¤. (ì„ ìƒë‹˜ê»˜ ì²­ì†Œ ë²”ìœ„ë¥¼ ì¢ê²Œ ì•Œë ¤ë“œë¦¬ëŠ” ë§¤ë„ˆ!)

### Q. í…ŒìŠ¤íŠ¸ê°€ ìš´ì˜ ë°ëª¬ê³¼ ì¶©ëŒí•´ìš”
- ê²©ë¦¬ëœ í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ë ¤ë©´ `scripts/run_tests_isolated.sh`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. (HOME/registry/log/port ë¶„ë¦¬)

### Q. ì—…ë°ì´íŠ¸ê°€ ì•ˆ ë˜ëŠ” ê²ƒ ê°™ì•„ìš”
- ì„¤ì¹˜ë³¸ `VERSION`ì„ í™•ì¸í•˜ì„¸ìš”:
  ```bash
  cat ~/.local/share/sari/VERSION
  ```
- í•„ìš”í•˜ë©´ ê°•ì œ ì—…ë°ì´íŠ¸:
  ```bash
  curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - --update -y
  ```

### Q. ì„¤ì • íŒŒì¼ì´ ì—¬ê¸°ì €ê¸° ìƒê²¼ì–´ìš”
- ì‚¬ë¦¬ ì„ ìƒë‹˜ì€ **ê¸€ë¡œë²Œ ì„¤ì •ê³¼ í”„ë¡œì íŠ¸ ì„¤ì •ì´ ë’¤ì„ì—¬ í˜¼ëˆì´ ì˜¤ëŠ” ê±¸ ê·¹ë„ë¡œ í˜ì˜¤í•©ë‹ˆë‹¤.**  
  ê·¸ë˜ì„œ ê¸€ë¡œë²Œ `~/.codex/config.toml`ì€ í‰í™”ë¡­ê²Œ ì •ë¦¬í•˜ê³ , **í”„ë¡œì íŠ¸ë³„ ì„œë(ì„¤ì •)**ë§Œ ì‚¬ìš©í•˜ë„ë¡ ìœ ë„í•©ë‹ˆë‹¤.  
  ì„¤ì •ì˜ ì§ˆì„œê°€ ê³§ ì½”ë“œì˜ í‰í™”ì…ë‹ˆë‹¤.

---

## ğŸ§© ì™œ ì„¤ì •ì„ ìë™ìœ¼ë¡œ ë‹¤ ì•ˆ ê³ ì³ì£¼ë‚˜ìš”?
Codex, Gemini, Claude, Cursorâ€¦ ì´ ë…€ì„ë“¤ì€ ì„±ê²©ë„ ë‹¤ë¥´ê³  ì‚¬ëŠ” ê³³(ì„¤ì • ê²½ë¡œ)ë„ ì œê°ê°ì´ì—ìš”.  
ì‚¬ë¦¬ ì„ ìƒë‹˜ì€ **â€œë‚¨ì˜ ì§‘ ì•ˆë°© ê°€êµ¬ ë°°ì¹˜ë¥¼ í•¨ë¶€ë¡œ ë°”ê¾¸ì§€ ì•Šê² ë‹¤â€**ëŠ” ì—„ê²©í•œ ë„ë•ì  ì² í•™ì´ ìˆìŠµë‹ˆë‹¤. ğŸ˜„  
(ì‚¬ì‹¤ ì˜ëª» ê±´ë“œë¦¬ë©´ ì§€ì˜¥ë¬¸ì´ ì—´ë¦´ ìˆ˜ ìˆì–´ì„œ ê·¸ë ‡ìŠµë‹ˆë‹¤.) ëŒ€ì‹  ì°¸ê³ í•  ìˆ˜ ìˆëŠ” **ë¹„ê¸‰ì„œ(ì„¤ì • ì˜ˆì‹œ)**ëŠ” ì•„ë˜ì— ì ì–´ë‘ì—ˆìœ¼ë‹ˆ ì§ì ‘ ì˜®ê²¨ ì ì–´ë³´ì‹œê²Œë‚˜!

---

## ğŸ® ì‚¬ë¦¬ ì„ ìƒë‹˜ ë¶€ë ¤ë¨¹ê¸° (Usage)

### 1ë‹¨ê³„: ë‚´ í”„ë¡œì íŠ¸ ê³µë¶€ì‹œí‚¤ê¸°
ì—¬ëŸ¬ë¶„ ê°œë°œ ì‹¤ë ¥ì˜ ê²°ì •ì²´(í˜¹ì€ ì§€ì˜¥ì—ì„œ ì˜¨ ìŠ¤íŒŒê²Œí‹° ì½”ë“œ)ì¸ í´ë”ë¡œ ì´ë™í•´ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”. ê·¸ëŸ¼ ì‚¬ë¦¬ ì„ ìƒë‹˜ì´ ì§€íŒ¡ì´ë¥¼ ì§šê³  ê·¸ í´ë”ë¥¼ ìƒ…ìƒ…ì´ ë’¤ì§€ê¸° ì‹œì‘í•©ë‹ˆë‹¤!

```bash
# macOS/Linux
$HOME/.local/share/sari/bootstrap.sh init

# Windows
%LOCALAPPDATA%\sari\bootstrap.bat init
```

> **ì°¸ê³ **: `--workspace-root`ë¥¼ ì‚¬ìš©í•˜ë©´ ì„ ìƒë‹˜ì˜ ì´ë™ ë²”ìœ„ë¥¼ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
> ì˜ˆ) `.../bootstrap.sh init --workspace-root /path/to/my_precious_code`

### 2ë‹¨ê³„: AIì—ê²Œ ë¬¼ì–´ë³´ê¸°
ì´ì œ AI ì¹œêµ¬(Codex, Claude, Cursor ë“±)ë¥¼ ì—´ê³  í‰ì†Œì²˜ëŸ¼ ì§ˆë¬¸í•´ë³´ì„¸ìš”.

> "ì‚¬ë¦¬ ì„ ìƒë‹˜ì˜ ì¥ë¶€ë¥¼ ë’¤ì ¸ì„œ **ë¡œê·¸ì¸ ë¡œì§**ì´ ì–´ëŠ ì§€ì˜¥ êµ¬ì„ì— ìˆëŠ”ì§€ ì°¾ì•„ì¤˜."  
> "ì´ í”„ë¡œì íŠ¸ì˜ **ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°**ë¥¼ ì„¤ëª…í•´ì£¼ê²Œë‚˜. ì‚¬ì„œ ì„ ìƒë‹˜ì´ ì•„ëŠ” ëŒ€ë¡œ ë§ì´ì•¼."

ê·¸ëŸ¼ AIê°€ ì‚¬ë¦¬ ì„ ìƒë‹˜ì—ê²Œ ë‹¬ë ¤ê°€ ì¥ë¶€ë¥¼ í™•ì¸í•˜ê³ , ì•„ì£¼ ì •í™•í•œ ë‹µë³€ì„ ì—¬ëŸ¬ë¶„ê»˜ ì•Œë ¤ì¤„ ê±°ì˜ˆìš”! (ê°€ë” ë‹µë³€ ëì— "Stay awhile and listen"ì´ë¼ê³  ë¶™ì—¬ë„ ë†€ë¼ì§€ ë§ˆì„¸ìš”.) âœ¨

---

## ğŸ“Š Sari MCP vs Standard Tools (ì‹¤ì¸¡ ê¸°ë°˜ ë¶„ì„)
ì•„ë˜ ìˆ˜ì¹˜ëŠ” **2026-02-02 ê¸°ì¤€, ì‹¤ì œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤(636 files)**ì—ì„œ ì‹¤ì¸¡í•œ ë°”ì´íŠ¸ í¬ê¸°ì…ë‹ˆë‹¤.  
ë¶„ì„ì— ì‚¬ìš©ëœ ì €ì¥ì†Œ ì´ë¦„/ì½”ë“œ ë‚´ìš©ì€ **ê³µê°œí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤**. (êµ¬ì¡°Â·í†µê³„ë§Œ ê³µê°œ)  
í† í° ì¶”ì •ì€ `1,000 bytes â‰ˆ 280 tokens` ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°í–ˆìŠµë‹ˆë‹¤. (ëª¨ë¸ë³„ ì˜¤ë²„í—¤ë“œëŠ” ì œì™¸)

### ì¸¡ì • ë°©ë²• ìš”ì•½
- Sari MCP: `status(details)`, `list_files`, `search_symbols` ì‘ë‹µì˜ **ë°”ì´íŠ¸ í¬ê¸° ì¸¡ì •**
- Standard Tools: `ls -R`, `rg --files`, `rg "class.*Application"` ì¶œë ¥ì˜ **ë°”ì´íŠ¸ í¬ê¸° ì¸¡ì •**
- ë™ì¼ ì›Œí¬ìŠ¤í˜ì´ìŠ¤/ë™ì¼ ì‹œì /ë™ì¼ í•„í„°ë¡œ ë¹„êµ

### 1) êµ¬ì¡° íƒìƒ‰ (íŒŒì¼ íŠ¸ë¦¬ íŒŒì•…)
| ë„êµ¬ | ì¸¡ì • í•­ëª© | ë°”ì´íŠ¸ | ì¶”ì • í† í° |
| --- | --- | ---:| ---:|
| Sari | `status(details)` | 1,649 | ~462 |
| Sari | `list_files` (limit=2000, returned=500) | 115,397 | ~32,311 |
| Standard | `ls -R` | 66,146 | ~18,521 |
| Standard | `rg --files` | 73,196 | ~20,495 |

**í•´ì„:**  
- `status(details)`ëŠ” êµ¬ì¡° íŒŒì•…ìš© ìš”ì•½ìœ¼ë¡œ **ì¶œë ¥ëŸ‰ì´ ê°€ì¥ ì‘ìŠµë‹ˆë‹¤.**  
- `list_files`ëŠ” JSON ë©”íƒ€ë°ì´í„° ë•Œë¬¸ì— **ì „ì²´ í˜¸ì¶œ ì‹œ ì¶œë ¥ëŸ‰ì´ ì»¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**
- ë”°ë¼ì„œ **ìš”ì•½ â†’ repo ì¢íˆê¸° â†’ ìƒì„¸** ìˆœìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ í† í° íš¨ìœ¨ì´ ë†’ìŠµë‹ˆë‹¤.

### 2) ì—”íŠ¸ë¦¬í¬ì¸íŠ¸ ì‹ë³„ (Application í´ë˜ìŠ¤ íƒìƒ‰)
| ë„êµ¬ | ì¸¡ì • í•­ëª© | ë°”ì´íŠ¸ | ê²°ê³¼ ìˆ˜ |
| --- | --- | ---:| ---:|
| Sari | `search_symbols Application` | 1,008 | 4 |
| Standard | `rg "class.*Application"` | 667 | 4 |

**í•´ì„:**  
- ì¶œë ¥ëŸ‰ì€ ìœ ì‚¬í•˜ì§€ë§Œ, SariëŠ” **ì‹¬ë³¼ íƒ€ì…/ê²½ë¡œ/ë¼ì¸ì„ êµ¬ì¡°í™”**í•´ ë°˜í™˜í•©ë‹ˆë‹¤.  
- í›„ì† ë‹¨ê³„(`read_symbol`)ë¡œ ì´ì–´ì§ˆ ë•Œ **ì¶”ê°€ íƒìƒ‰ ë¹„ìš©ì´ ì¤„ì–´ë“­ë‹ˆë‹¤.**

### 3) ê²°ë¡  (ì‹¤ì¸¡ ê¸°ë°˜)
SariëŠ” **â€œìš”ì•½ â†’ ì¢íˆê¸° â†’ ì‹¬ë³¼ ì½ê¸°â€** ì›Œí¬í”Œë¡œìš°ì—ì„œ ê°€ì¥ íš¨ìœ¨ì ì…ë‹ˆë‹¤.  
ë°˜ëŒ€ë¡œ `list_files`ë¥¼ ì „ì²´ì— ë¬´ì‹¬ì½” í˜¸ì¶œí•˜ë©´ í† í° ë¹„ìš©ì´ ì»¤ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ,  
**repo ì§€ì • ë˜ëŠ” ìš”ì•½ ëª¨ë“œ**ë¥¼ ë°˜ë“œì‹œ ì‚¬ìš©í•˜ì„¸ìš”.

---

## âš¡ ì„±ëŠ¥ê³¼ ë¹„ìš© ìµœì í™” ê°€ì´ë“œ
SariëŠ” ì¸ë±ì‹± + FTS ê¸°ë°˜ ê²€ìƒ‰ êµ¬ì¡°ë¼ì„œ **â€œì–´ë–¤ ë‹¨ê³„ì—ì„œ ì“°ëŠëƒâ€**ì— ë”°ë¼ ì²´ê° ì„±ëŠ¥ì´ í¬ê²Œ ë‹¬ë¼ì§‘ë‹ˆë‹¤.

### 1) êµ¬ì¡° íŒŒì•…: ìš”ì•½ ëª¨ë“œê°€ ê¸°ë³¸
- **ê¶Œì¥:** `status(details)` â†’ `repo_candidates` â†’ `list_files(repo=...)`
- `list_files`ëŠ” **repo ë¯¸ì§€ì • ì‹œ ìš”ì•½ ëª¨ë“œ**ë¡œ ë™ì‘í•©ë‹ˆë‹¤.  
  í° ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì—ì„œ **ì „ì²´ íŒŒì¼ ëª©ë¡ì„ í•œ ë²ˆì— ë¤í”„í•˜ë©´ ë¹„ìš©/í† í° í­ì£¼**ê°€ ë°œìƒí•©ë‹ˆë‹¤.
 - HTTP ìš”ì²­ì€ **ìŠ¤ë ˆë“œë³„ read ì „ìš© ì»¤ë„¥ì…˜**ì„ ì‚¬ìš©í•´ ë³‘ë ¬ ì²˜ë¦¬ íš¨ìœ¨ì„ ë†’ì…ë‹ˆë‹¤.

### 2) ê²€ìƒ‰ ì†ë„: FTSê°€ ì¼œì ¸ ìˆëŠ”ì§€ í™•ì¸
- `status(details)`ì—ì„œ `fts_enabled: true`ì¸ì§€ ë¨¼ì € í™•ì¸í•˜ì„¸ìš”.  
- `fts_enabled: false`ë©´ ê²€ìƒ‰ì´ LIKE í´ë°±ìœ¼ë¡œ ì „í™˜ë˜ì–´ **ëŠë ¤ì§€ê³  ì •í™•ë„ë„ ë–¨ì–´ì§‘ë‹ˆë‹¤.**
- FTSê°€ ì¼œì ¸ ìˆì–´ë„ **ì•„ì£¼ ì§§ì€ ì¿¼ë¦¬(ê¸¸ì´ < 3)** ë˜ëŠ” **ìœ ë‹ˆì½”ë“œ í¬í•¨ ì¿¼ë¦¬**ëŠ” LIKEë¡œ í´ë°±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- íŒŒì¼ ìˆ˜ê°€ ë§ê³  ê²€ìƒ‰ì´ ëŠë¦¬ë‹¤ë©´ `status(details)`ì— **ì—”ì§„ ì¶”ì²œ ê²½ê³ **ê°€ í‘œì‹œë©ë‹ˆë‹¤.
  - ê¸°ë³¸ ê¸°ì¤€: **10,000 files ì´ìƒ**ì´ë©´ embedded(Tantivy) ê¶Œì¥
  - ì„ê³„ê°’: `DECKARD_ENGINE_SUGGEST_FILES`
- FTSëŠ” **ì••ì¶• í•´ì œ ë³‘ëª©ì„ í”¼í•˜ê¸° ìœ„í•´** ë³„ë„ì˜ `fts_content` ì»¬ëŸ¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. (ê²€ìƒ‰ CPU ë¶€ë‹´ ê°ì†Œ)

### 3) ì—”íŠ¸ë¦¬í¬ì¸íŠ¸ íƒìƒ‰ì€ ì‹¬ë³¼ ê¸°ë°˜ì´ ìœ ë¦¬
- `search_symbols` â†’ `read_symbol` ì¡°í•©ì€ **í•„ìš”í•œ ì½”ë“œ ë¸”ë¡ë§Œ ì½ì–´** í† í° ë¹„ìš©ì„ ì¤„ì…ë‹ˆë‹¤.
- `read_file`ì€ â€œì •ë§ ì „ì²´ íŒŒì¼ì´ í•„ìš”í•  ë•Œë§Œâ€ ì‚¬ìš©í•˜ì„¸ìš”.
- êµ¬ì¡°ì  ë­í‚¹(Structural Boosting)ì´ ì ìš©ë˜ì–´ **class/function/method ì‹¬ë³¼ì€ ë” ë†’ì€ ì ìˆ˜**ë¥¼ ë°›ìŠµë‹ˆë‹¤.
- `search`ëŠ” **ì •í™•í•œ ì‹¬ë³¼ ì´ë¦„ ë§¤ì¹­**ì— ì¶”ê°€ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.

### 4) í° ë ˆí¬ì¼ìˆ˜ë¡ í•„í„°ë§ì´ í•µì‹¬
- `repo`, `file_types`, `path_pattern`ì„ ì ê·¹ ì‚¬ìš©í•˜ì„¸ìš”.
- ì˜ˆ) `list_files { repo: "sari", file_types: ["py"] }`

### 5) ëŒ€ëŸ‰ ë¸Œëœì¹˜ ë³€ê²½(Git checkout) ëŒ€ì‘
- `.git` ì´ë²¤íŠ¸ ê°ì§€ ì‹œ **ê°œë³„ íŒŒì¼ ì´ë²¤íŠ¸ ëŒ€ì‹  rescan**ìœ¼ë¡œ í•©ì³ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- debounceëŠ” `DECKARD_GIT_CHECKOUT_DEBOUNCE` (ê¸°ë³¸ 3ì´ˆ)

### 6) ëŒ€ëŸ‰ ì´ë²¤íŠ¸ ì„±ëŠ¥/ë³µêµ¬
- ì¸ë±ì‹± ì½”ì–¼ë ˆìŠ¤ëŠ” **Sharded Lock**ìœ¼ë¡œ ë¶„ì‚°ë˜ì–´ ëŒ€ê·œëª¨ ì´ë²¤íŠ¸ì—ì„œ ë³‘ëª©ì„ ì¤„ì…ë‹ˆë‹¤.
  - ìƒ¤ë“œ ìˆ˜: `DECKARD_COALESCE_SHARDS` (ê¸°ë³¸ 16)
- ì‹¤íŒ¨í•œ ì¸ë±ì‹± ì‘ì—…ì€ **DLQ(Dead Letter Queue)** ë¡œ ì €ì¥ë©ë‹ˆë‹¤.
  - ì¬ì‹œë„ ê°„ê²©: 1ë¶„ â†’ 5ë¶„ â†’ 1ì‹œê°„
  - `doctor`ì—ì„œ 3íšŒ ì´ìƒ ì‹¤íŒ¨í•œ í•­ëª©ì„ ê²½ê³ ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.

---

## ğŸ› ï¸ ë‚´ê°€ ì“°ëŠ” ì•±ì— ì—°ê²°í•˜ê¸° (ìƒì„¸ ê°€ì´ë“œ)

### ğŸ¤– Claude Desktop ì•± ì—°ë™
ì„¤ì • íŒŒì¼(`claude_desktop_config.json`)ì„ ì°¾ì•„ì„œ ì•„ë˜ ë‚´ìš©ì„ ì™ ë„£ì–´ì£¼ì„¸ìš”.  
ì´ê±´ ë§ˆì¹˜ ì„ ìƒë‹˜ ì´ë¦„í‘œë¥¼ ë‹¬ì•„ì£¼ëŠ” ì‘ì—…ì…ë‹ˆë‹¤.

**macOS / Linux**
```json
{
  "mcpServers": {
    "sari": {
      "command": "bash",
      "args": [
        "-lc",
        "export PATH=$PATH:/usr/local/bin:/opt/homebrew/bin:$HOME/.local/bin && (curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - -y || true) && exec ~/.local/share/sari/bootstrap.sh --transport stdio"
      ],
      "env": {
        "DECKARD_WORKSPACE_ROOT": "/Users/[ì‚¬ìš©ìëª…]/path/to/workspace",
        "DECKARD_RESPONSE_COMPACT": "1"
      }
    }
  }
}
```

**Windows**
```json
{
  "mcpServers": {
    "sari": {
      "command": "powershell",
      "args": [
        "-NoProfile", "-ExecutionPolicy", "Bypass", "-Command",
        "irm https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python - -y; & $env:LOCALAPPDATA\\sari\\bootstrap.bat --transport stdio"
      ],
      "env": {
        "DECKARD_WORKSPACE_ROOT": "C:\\path\\to\\workspace",
        "DECKARD_RESPONSE_COMPACT": "1"
      }
    }
  }
}
```

### ğŸ§© Codex / Gemini ì„¤ì • ì˜ˆì‹œ (config.toml)

**macOS / Linux**
```toml
[mcp_servers.sari]
command = "bash"
args = ["-lc", "export PATH=$PATH:/usr/local/bin:/opt/homebrew/bin:$HOME/.local/bin && (curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - -y || true) && exec ~/.local/share/sari/bootstrap.sh --transport stdio"]
env = { DECKARD_WORKSPACE_ROOT = "/Users/[ì‚¬ìš©ìëª…]/path/to/workspace", DECKARD_RESPONSE_COMPACT = "1" }
startup_timeout_sec = 60
```

**Windows**
```toml
[mcp_servers.sari]
command = "powershell"
args = ["-NoProfile", "-ExecutionPolicy", "Bypass", "-Command", "irm https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python - -y; & $env:LOCALAPPDATA\\sari\\bootstrap.bat --transport stdio"]
env = { DECKARD_WORKSPACE_ROOT = "C:\\path\\to\\workspace", DECKARD_RESPONSE_COMPACT = "1" }
startup_timeout_sec = 60
```

**í•„ë“œë³„ ìƒì„¸ ì„¤ëª…**
- `command`: ì‚¬ë¦¬ë¥¼ ì‹¤í–‰í•  ê²½ë¡œì…ë‹ˆë‹¤.  
- `command`: ê¸°ë³¸ì€ `bash` (ë„¤íŠ¸ì›Œí¬ ìë™ ì„¤ì¹˜ ë°©ì‹).
- `args`: `curl | python3`ë¡œ ì„¤ì¹˜ í›„ `bootstrap.sh` ì‹¤í–‰.
- `env`: í™˜ê²½ ë³€ìˆ˜ë¥¼ ê°•ì œë¡œ ì£¼ì…í•©ë‹ˆë‹¤.  
  - `DECKARD_WORKSPACE_ROOT`ëŠ” **workspace-rootë¥¼ ê³ ì •**í•˜ë ¤ê³  ë„£ìŠµë‹ˆë‹¤.  
- `startup_timeout_sec`: ë°ëª¬ ê¸°ë™ ëŒ€ê¸° ì‹œê°„(ì´ˆ).  
  ì´ˆê¸° ì¸ë±ì‹±ì´ ê¸¸ë‹¤ë©´ 120~180ìœ¼ë¡œ ëŠ˜ë ¤ë³´ì„¸ìš”.

**ì„¤ì • ê²½ë¡œ ìš°ì„ ìˆœìœ„(ìš”ì•½)**  
1) `DECKARD_CONFIG` / `LOCAL_SEARCH_CONFIG`  
2) `<workspace>/.codex/tools/sari/config/config.json`  
3) íŒ¨í‚¤ì§€ ê¸°ë³¸ config

### ğŸ“ˆ í…”ë ˆë©”íŠ¸ë¦¬ ë¡œê·¸
- `tool=search`/`tool=list_files` ë“± ë„êµ¬ ì‹¤í–‰ ë¡œê·¸ê°€ ê¸°ë¡ë©ë‹ˆë‹¤.
- `search-first` ì •ì±… ìœ„ë°˜/ê²½ê³ ëŠ” ë³„ë„ ë¡œê·¸ í•­ëª©ìœ¼ë¡œ ë‚¨ìŠµë‹ˆë‹¤.

### ğŸ§µ ì‘ë‹µ ì••ì¶• ëª¨ë“œ
- `DECKARD_RESPONSE_COMPACT=1`ì´ë©´ MCP ì‘ë‹µ JSONì´ **minified**ë¡œ ì¶œë ¥ë©ë‹ˆë‹¤. (ê¸°ë³¸ê°’)
- `DECKARD_RESPONSE_COMPACT=0`ì´ë©´ ê¸°ì¡´ pretty JSON ì¶œë ¥ìœ¼ë¡œ ë³µì›ë©ë‹ˆë‹¤.
- `list_files`ëŠ” compact ëª¨ë“œì—ì„œ `paths`ë§Œ ë°˜í™˜í•©ë‹ˆë‹¤. (verbose ëª¨ë“œì—ì„œë§Œ `files/meta`)

**ì—¬ëŸ¬ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë„£ì„ ìˆ˜ ìˆë‚˜ìš”?**
- í˜„ì¬ëŠ” `--workspace-root` **ë‹¨ì¼ ê²½ë¡œë§Œ ì§€ì›**í•©ë‹ˆë‹¤.
- ì—¬ëŸ¬ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ì“°ë ¤ë©´ ê° ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë§ˆë‹¤ ë³„ë„ ì„¤ì •ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

**env ì—†ì´ë„ ë˜ë‚˜ìš”?**
- ë©ë‹ˆë‹¤. `args`ì— `--workspace-root`ê°€ ìˆìœ¼ë©´ ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤.
- ë‹¤ë§Œ **í™˜ê²½ ë³€ìˆ˜ê°€ ìš°ì„ **ë˜ë„ë¡ ì‚¬ìš© í™˜ê²½ì´ êµ¬ì„±ëœ ê²½ìš°ê°€ ìˆì–´, í˜¼ì„ ì„ ì¤„ì´ë ¤ë©´ `args`ì™€ `env`ë¥¼ ê°™ì´ ë§ì¶°ë‘ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤.

**argsì™€ envê°€ ì„œë¡œ ë‹¤ë¥´ë©´?**
- `DECKARD_WORKSPACE_ROOT`(í™˜ê²½ ë³€ìˆ˜)ê°€ ì™•ì˜ ê¶Œìœ„ë¥¼ ê°€ì§‘ë‹ˆë‹¤.  
  í•˜ì§€ë§Œ ë‘ ê°’ì´ ë‹¤ë¥´ë©´ ì„ ìƒë‹˜ì´ "ì–´ë””ë¡œ ê°€ë¼ëŠ” ê±´ê°€!" í•˜ê³  ì§€íŒ¡ì´ë¥¼ íœ˜ë‘ë¥´ì‹¤ í…Œë‹ˆ, **í•­ìƒ ë™ì¼í•˜ê²Œ ë§ì¶”ëŠ” ê±¸ ì¶”ì²œ**í•˜ë„¤.

### ğŸ’¡ Cursor/CLIì—ì„œ ì˜µì…˜ ë„£ëŠ” ë°©ë²•
Cursor/Claude/Gemini/Codex ê°™ì€ MCP í´ë¼ì´ì–¸íŠ¸ëŠ” **env ë¸”ë¡ìœ¼ë¡œ ì˜µì…˜ ì£¼ì…**ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.  
CLIë§Œ ì“°ëŠ” ê²½ìš°ì—” ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.

**A) ì‰˜ì—ì„œ ì§ì ‘ env ì§€ì •**
```bash
DECKARD_ENGINE_TOKENIZER=cjk DECKARD_ENGINE_AUTO_INSTALL=1 \
  ~/.local/share/sari/bootstrap.sh --transport stdio
```

**B) ë˜í¼ ìŠ¤í¬ë¦½íŠ¸**
```bash
#!/usr/bin/env bash
export DECKARD_ENGINE_TOKENIZER=cjk
export DECKARD_ENGINE_AUTO_INSTALL=1
exec ~/.local/share/sari/bootstrap.sh --transport stdio
```

**`--workspace-root`ë¥¼ ìƒëµí•˜ë©´ ì–´ë–¤ ì¬ì•™ì´?**
- ì‹¤í–‰ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë©‹ëŒ€ë¡œ ì¶”ì •í•©ë‹ˆë‹¤.  
  - í˜„ì¬ í´ë” ë˜ëŠ” ìƒìœ„ í´ë”ì— `.codex-root`ê°€ ìˆìœ¼ë©´ "ì°¾ì•˜ë‹¤!" í•˜ê³  ì‚¬ìš©
  - ì—†ë‹¤ë©´ **í˜„ì¬ í´ë” ì „ì²´**ë¥¼ ìê¸° ì•ˆë°©ì¸ ì¤„ ì••ë‹ˆë‹¤.

**ì˜ˆ: í™ˆ ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤ìˆ˜ë¡œ ì‹¤í–‰í•˜ë©´?**
- ì˜ë„ì¹˜ ì•Šê²Œ ì—¬ëŸ¬ë¶„ì˜ 'ë¹„ë°€ ì‚¬ì§„ì²©'ê³¼ 'ë‹¤ìš´ë¡œë“œ í´ë”' ì „ì²´ê°€ í˜¸ë¼ë“œë¦¼ ì¥ë¶€ì— ê¸°ë¡ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
  ì •ì‹  ê±´ê°•ì„ ìœ„í•´ `--workspace-root`ë¥¼ ëª…ì‹œí•˜ëŠ” ê²ƒì„ **ê°•ë ¥í•˜ê³  ê°„ì ˆí•˜ê²Œ** ì¶”ì²œí•˜ë„¤.

**ì„¤ì • íŒŒì¼ì´ ë‘ êµ°ë° ìˆìœ¼ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?**
- ì‚¬ë¦¬ ì„ ìƒë‹˜ì€ **í”„ë¡œì íŠ¸ ì„¤ì •(í˜„ì¥ ì¤‘ì‹¬)**ì„ ê°€ì¥ ì‹ ë¢°í•©ë‹ˆë‹¤.  
  ê¸€ë¡œë²Œ ì„¤ì •ê³¼ í•¨ê»˜ ì¡´ì¬í•˜ë©´ ì„ ìƒë‹˜ì´ í—·ê°ˆë ¤í•˜ì‹œë‹ˆ,  
  `install.py`ëŠ” ìë¹„ë¡­ê²Œ ê¸€ë¡œë²Œì˜ `sari` ë¸”ë¡ì„ ì œê±°í•´ ë²„ë¦°ë‹¤ë„¤. (ì˜¤ì§ ì§ˆì„œ!)

### âŒ¨ï¸ Cursor (AI ì—ë””í„°) ì—°ë™
1.  **í™˜ê²½ì„¤ì •(Settings)** > **MCP** ë©”ë‰´ë¥¼ í´ë¦­í•˜ì„¸ìš”.
2.  **+ Add New MCP Server** ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤.
3.  ì´ë¦„ì—” `sari`, íƒ€ì…ì€ `stdio`ë¥¼ ì„ íƒí•˜ì„¸ìš”.
4.  Command ì¹¸ì— `/Users/[ì‚¬ìš©ìëª…]/.local/share/sari/bootstrap.sh`ë¥¼ ì…ë ¥í•˜ê³  'Save' í•˜ë©´ ë!

---

## ğŸ—‘ï¸ ë„ì„œê´€ íì‡„ (ì‚­ì œ ë°©ë²• - Uninstall)

ì´ì œ ì„±ì—­ì— í‰í™”ê°€ ì°¾ì•„ì™”ê±°ë‚˜, ì„ ìƒë‹˜ì˜ ì”ì†Œë¦¬ê°€ ë“£ê¸° ì‹«ë‹¤ë©´ ì–¸ì œë“  ë³´ë‚´ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í„°ë¯¸ë„ì— ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”. (ëˆˆë¬¼ ì£¼ì˜)

```bash
# ë§ˆë²• ì£¼ë¬¸ì— --uninstall ì˜µì…˜ì„ ë¶™ì´ë©´ ì„ ìƒë‹˜ì´ ì§ì„ ì‹¸ì„œ ë– ë‚˜ì‹­ë‹ˆë‹¤.
curl -fsSL https://raw.githubusercontent.com/BaeCheolHan/sari/main/install.py | python3 - --uninstall
```

ë˜ëŠ” ì„¤ì¹˜ë³¸ ê¸°ì¤€ìœ¼ë¡œ ì´ë ‡ê²Œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤:
```bash
# macOS/Linux
~/.local/share/sari/bootstrap.sh uninstall

# Windows
%LOCALAPPDATA%\sari\bootstrap.bat uninstall
```

### ì‚­ì œí•˜ë©´ ë¬´ì—‡ì´ ì •í™”ë˜ë‚˜ìš”? (ì´ë³„ì˜ ë¯¸í•™)
- **ê±°ì²˜ ì •í™”**: ì‚¬ë¦¬ ì„ ìƒë‹˜ì´ ë¨¸ë¬¼ë˜ ë„ì„œê´€ê³¼ ë‚¡ì€ ì¥ë¶€(index.db)ë¥¼ íŠ¸ë¦¬ìŠ¤íŠ¸ëŸ¼ì˜ ë¶ˆê¸¸ë¡œ ì†Œë©¸ì‹œí‚µë‹ˆë‹¤.
- **ìŒë‘¥ì´ ìœ ë ¹ í‡´ì¹˜**: `install.py --uninstall`ì€ Codexì™€ Gemini ì–‘ìª½ì˜ ì¸ì¥ì„ ëª¨ë‘ ì§€ì›Œë²„ë¦¬ëŠ” ê°•ë ¥í•œ ì •í™” ì˜ì‹ì„ ê±°í–‰í•©ë‹ˆë‹¤.
- **ì„ íƒì  ì‘ë³„**: `bootstrap.sh uninstall`ì€ ì˜¤ì§ Codexì˜ ì¸ì¥ë§Œ ì§€ìš°ê³  ë– ë‚˜ëŠ” ì ˆì œëœ ì´ë³„ì„ ì„ ì‚¬í•©ë‹ˆë‹¤. (Gemini/Claude ë“±ì€ ê·¸ëŒ€ë¡œ ë‚¨ìŠµë‹ˆë‹¤.)
- **ìœˆë„ìš° ì£¼ì˜**: `bootstrap.bat uninstall`ì€ **ì„¤ì • íŒŒì¼ì„ ì •ë¦¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.** í•„ìš”í•˜ë©´ ìˆ˜ë™ìœ¼ë¡œ `config.toml`ì—ì„œ `sari` ë¸”ë¡ì„ ì œê±°í•˜ì„¸ìš”.
- **ê¹”ë”í•œ ìŠ¹ì²œ**: ì—¬ëŸ¬ë¶„ì˜ ì»´í“¨í„°ì— ê·¸ ì–´ë–¤ ì§€ì˜¥ì˜ ì°Œêº¼ê¸°ë„ ë‚¨ê¸°ì§€ ì•Šê³  ê³ ê²°í•˜ê²Œ ì‚¬ë¼ì§€ì‹­ë‹ˆë‹¤!

---

## ğŸ¤– MCP ì‘ë‹µ í¬ë§· (PACK1) ê°€ì´ë“œ

ì‚¬ë¦¬ v2.5.0ë¶€í„°ëŠ” í† í° ì ˆì•½ì„ ìœ„í•´ **PACK1**ì´ë¼ëŠ” ì••ì¶• í…ìŠ¤íŠ¸ í¬ë§·ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. JSONì˜ ë¶ˆí•„ìš”í•œ ê´„í˜¸ì™€ ê³µë°±ì„ ì œê±°í•˜ì—¬ **ì•½ 30~50%ì˜ í† í°ì„ ì ˆì•½**í•©ë‹ˆë‹¤.

### 1. í¬ë§· ê°œìš”
- **í—¤ë”(Header)**: `PACK1 <tool> key=value ...`
- **ë ˆì½”ë“œ(Record)**: `<type>:<payload>` (í•œ ì¤„ì— í•˜ë‚˜ì”©)
- **ì¸ì½”ë”©**: íŠ¹ìˆ˜ë¬¸ìë‚˜ ê³µë°±ì´ í¬í•¨ëœ ê°’ì€ ì•ˆì „í•˜ê²Œ URL ì¸ì½”ë”©ë©ë‹ˆë‹¤.
  - `ENC_ID`: ì‹ë³„ììš© (ê²½ë¡œ, ì´ë¦„ ë“±). `safe="/._-:@"`
  - `ENC_TEXT`: ì¼ë°˜ í…ìŠ¤íŠ¸ìš© (ìŠ¤ë‹ˆí«, ë©”ì‹œì§€ ë“±). `safe=""`

### 2. ì£¼ìš” ë„êµ¬ ì˜ˆì‹œ

**`list_files`**
```text
PACK1 list_files offset=0 limit=100 returned=2 total=2 total_mode=exact
p:src/main.py
p:src/utils.py
```

**`search_symbols`**
```text
PACK1 search_symbols q=User limit=50 returned=1 total_mode=none
h:repo=my-repo path=src/user.py line=10 kind=class name=User
```

**`status`**
```text
PACK1 status returned=5
m:index_ready=true
m:scanned_files=100
m:indexed_files=100
m:errors=0
m:fts_enabled=true
```

### 3. ì—ëŸ¬ ì½”ë“œ (Error Codes)
ì˜¤ë¥˜ ë°œìƒ ì‹œ `PACK1 <tool> ok=false` í—¤ë”ì™€ í•¨ê»˜ ì•„ë˜ ì½”ë“œê°€ ë°˜í™˜ë©ë‹ˆë‹¤.

| ì½”ë“œ | ì„¤ëª… |
|---|---|
| `INVALID_ARGS` | ì˜ëª»ëœ ì¸ì ì „ë‹¬ |
| `NOT_INDEXED` | ì¸ë±ì‹±ì´ ì™„ë£Œë˜ì§€ ì•ŠìŒ |
| `REPO_NOT_FOUND` | ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì €ì¥ì†Œ |
| `IO_ERROR` | íŒŒì¼ ì½ê¸°/ì“°ê¸° ì‹¤íŒ¨ |
| `DB_ERROR` | ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ |
| `INTERNAL` | ë‚´ë¶€ ì„œë²„ ì˜¤ë¥˜ |

> **ì°¸ê³ **: ê¸°ì¡´ JSON í¬ë§·ì´ í•„ìš”í•˜ë‹¤ë©´ í™˜ê²½ë³€ìˆ˜ `DECKARD_FORMAT=json`ì„ ì„¤ì •í•˜ì„¸ìš”. (ë””ë²„ê¹…ìš©)
> ì—ëŸ¬ì—ëŠ” `hint`ê°€ í•¨ê»˜ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì˜ˆ: `run scan_once`, `run sari doctor`)

---

## ğŸ©º MCP status/doctor ê²½ê³  ì•ˆë‚´
ì•„ë˜ ìƒíƒœëŠ” **MCP `status`/`doctor`ì—ì„œ ê²½ê³ ë¡œ ë…¸ì¶œ**ë©ë‹ˆë‹¤.

**1) tokenizer ë“±ë¡ ì‹¤íŒ¨**  
`engine tokenizers not registered; using default tokenizer`

**2) í”Œë«í¼ìš© ë²ˆë“¤ ëˆ„ë½**  
`tokenizer bundle not found for <platform_tag>`

í•´ê²°:
- `app/engine_tokenizer_data/`ì— í•´ë‹¹ OSìš© wheel í¬í•¨
- í•„ìš” ì‹œ `scripts/prune_tokenizer_bundles.sh`ë¡œ ì •ë¦¬

---

## ğŸ—ï¸ ê°œë°œìë¥¼ ìœ„í•œ ì œì› (Tech Specs)

- **ì–¸ì–´**: Python 3.9+ (í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œ ì‚¬ìš©í•˜ëŠ” ì œë¡œ ë””íœë˜ì‹œ!)
- **DB**: SQLite (WAL ëª¨ë“œ) + FTS5 (ì „ë¬¸ ê²€ìƒ‰ ê¸°ìˆ )
- **í†µì‹ **: MCP (Model Context Protocol) 
- **êµ¬ì¡°**: 
    - **Daemon**: ì‹¤ì œë¡œ ê³µë¶€í•˜ê³  ê²€ìƒ‰ì„ ì²˜ë¦¬í•˜ëŠ” í•µì‹¬ ë³¸ì²´
    - **Proxy**: AI ì•±ê³¼ Daemon ì‚¬ì´ì˜ ë¹ ë¥¸ ë©”ì‹ ì €

---

## ğŸ§  ì§€ì‹ ë„êµ¬ (Call Graph / Snippet / Context / Dry-run Diff)

### 1) Call Graph (í˜¸ì¶œ ê´€ê³„)
MCP tool: `call_graph`  
CLI:
```bash
sari call-graph --symbol process_file --depth 2
# ì‹¬ë³¼ì´ ê²¹ì¹  ë•ŒëŠ” symbol_idë¡œ ì •í™•íˆ ì§€ì •
sari call-graph --symbol-id "<sid>" --depth 2
# íŠ¸ë¦¬ ì¶œë ¥
sari call-graph --symbol process_file --depth 2 --format tree
# ê²½ë¡œ í•„í„°
sari call-graph --symbol process_file --include-path sari/core --exclude-path tests
# ì •ë ¬ ê¸°ì¤€
sari call-graph --symbol process_file --format tree --sort name
```
ì„¤ëª…:
- `search_symbols` ê²°ê³¼ì— `qualname`/`symbol_id`ê°€ í¬í•¨ë©ë‹ˆë‹¤.
- `symbol_id`ë¥¼ ì „ë‹¬í•˜ë©´ í˜¸ì¶œ ê´€ê³„ê°€ í›¨ì”¬ ì •í™•í•˜ê²Œ ë§¤í•‘ë©ë‹ˆë‹¤.
- `DECKARD_CALLGRAPH_PLUGIN`ìœ¼ë¡œ ì •ì  ë¶„ì„ í”ŒëŸ¬ê·¸ì¸ì„ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ì—¬ëŸ¬ ê°œëŠ” ì‰¼í‘œë¡œ ì—°ê²°: `mod1,mod2`
  - `augment_neighbors(direction, neighbors, context)` ë˜ëŠ” `filter_neighbors(...)` êµ¬í˜„ ê°€ëŠ¥.
  - ì—ëŸ¬ ë¡œê·¸: `DECKARD_CALLGRAPH_PLUGIN_LOG=/tmp/callgraph.log`
- ì •í™•ë„ íŒíŠ¸ê°€ `precision_hint`ë¡œ ì œê³µë©ë‹ˆë‹¤ (ì–¸ì–´ë³„ ì„¸ë¶„í™”).
- `search_symbols` ê²°ê³¼ì—ë„ `precision_hint`ê°€ í¬í•¨ë©ë‹ˆë‹¤.
  - í”ŒëŸ¬ê·¸ì¸ ë§¤ë‹ˆí˜ìŠ¤íŠ¸: `DECKARD_CALLGRAPH_PLUGIN_MANIFEST=/path/to/manifest.json`
  - ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ìŠ¤í‚¤ë§ˆ:
    - JSON ë¦¬ìŠ¤íŠ¸: `["mod1", "mod2"]`
    - ë˜ëŠ” ê°ì²´: `{"plugins": ["mod1", "mod2"]}`
  - strict ê²€ì¦: `DECKARD_CALLGRAPH_PLUGIN_MANIFEST_STRICT=1`
  - `call_graph_health`ì—ì„œ API ë¶ˆì¼ì¹˜/ë¡œë“œ ì‹¤íŒ¨ ì›ì¸ í™•ì¸ ê°€ëŠ¥
  - `quality_score` (0-100)ë¡œ ì •ì  í•´ì„ ì‹ ë¢°ë„ ì œê³µ (íŒŒì¼ í¬ê¸°/ê´€ê³„ ë°€ë„ ë°˜ì˜)

ì–¸ì–´ë³„ íŠ¹ì´ì‚¬í•­:
- **Python**: AST ê¸°ë°˜, ì •í™•ë„ ë†’ìŒ. ë™ì  í˜¸ì¶œ/ë¦¬í”Œë ‰ì…˜ì€ í•œê³„.
- **JS/TS/Java/Kotlin/Go/C/C++**: ì •ê·œì‹ ê¸°ë°˜ íŒŒì„œë¡œ í˜¸ì¶œ ê´€ê³„ ì •ë°€ë„ ë‚®ìŒ.
  - ì˜¤ë²„ë¡œë“œ/ì¸í„°í˜ì´ìŠ¤/ë¦¬í”Œë ‰ì…˜/ë™ì  ë””ìŠ¤íŒ¨ì¹˜ì— ì•½í•¨.
  - ë™ì¼ ì´ë¦„ ì‹¬ë³¼ ì¶©ëŒ ê°€ëŠ¥ â†’ `symbol_id` ê¶Œì¥.

### 2) Save / Get Snippet
MCP tools: `save_snippet`, `get_snippet`  
CLI:
```bash
sari save-snippet --path "core/db.py:100-150" --tag "db-connection-pattern"
sari get-snippet --tag "db-connection-pattern"
sari get-snippet --tag "db-connection-pattern" --history
sari get-snippet --tag "db-connection-pattern" --no-remap
sari get-snippet --tag "db-connection-pattern" --update
sari get-snippet --tag "db-connection-pattern" --update --diff-path /tmp/snippet.diff
```
ì„¤ëª…:
- ì €ì¥ ì‹œ ìŠ¤ë‹ˆí« ì£¼ë³€ ì•µì»¤(ì•/ë’¤ ë¼ì¸)ë¥¼ í•¨ê»˜ ê¸°ë¡í•©ë‹ˆë‹¤.
- íŒŒì¼ì´ ë°”ë€Œì–´ë„ `get_snippet`ì€ ì•µì»¤/ë‚´ìš© ë§¤ì¹­ìœ¼ë¡œ ìë™ ì¬ë§¤í•‘(remap)í•©ë‹ˆë‹¤.
- ìŠ¤ë‹ˆí« ë‚´ìš©ì´ ë°”ë€Œë©´ ì´ì „ ë²„ì „ì´ `snippet_versions`ì— ìë™ ë³´ê´€ë©ë‹ˆë‹¤.
- `--update`ë¥¼ ì‚¬ìš©í•˜ë©´ ë¦¬ë§¤í•‘ëœ ìœ„ì¹˜/ë‚´ìš©ì„ DBì— ë°˜ì˜í•©ë‹ˆë‹¤.
- ë¦¬ë§¤í•‘ ê²°ê³¼ì—ëŠ” `diff`(ë³€ê²½ ìš”ì•½)ê°€ í¬í•¨ë©ë‹ˆë‹¤.
- `--diff-path`ë¥¼ ì§€ì •í•˜ë©´ diffë¥¼ íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.
- `--diff-path`ê°€ ë¹„ì–´ ìˆìœ¼ë©´ ê¸°ë³¸ ê²½ë¡œëŠ” `~/.cache/sari/snippet-diffs/<tag>.diff` ì…ë‹ˆë‹¤.
- `--update` ì‹œ ì €ì¥ëœ ìŠ¤ëƒ…ìƒ·: `<tag>_<id>_<ts>_stored.txt`, `<tag>_<id>_<ts>_current.txt`
- ë¦¬ë§¤í•‘ì´ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ì—…ë°ì´íŠ¸ê°€ ìŠ¤í‚µë©ë‹ˆë‹¤ (`update_skipped_reason`).

### 3) Archive / Get Context
MCP tools: `archive_context`, `get_context`  
CLI:
```bash
sari archive-context --topic "PricingLogic" --content "ì¿ í° ì ìš© ì „ í• ì¸ ê³„ì‚°" --related-files core/pricing.py api/payment.py
sari archive-context --topic "PricingLogic" --content "..." --source "issue-102" --valid-from 2024-02-01
sari get-context --topic "PricingLogic"
sari get-context --query "Pricing" --as-of 2024-06-01
```
ì„¤ëª…:
- `source`, `valid_from`, `valid_until`, `deprecated`ë¥¼ ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `get_context --as-of`ëŠ” ì‹œì  ê¸°ì¤€ìœ¼ë¡œ ìœ íš¨í•œ ì»¨í…ìŠ¤íŠ¸ë§Œ ë°˜í™˜í•©ë‹ˆë‹¤.

### 4) Dry-run Diff
MCP tool: `dry_run_diff`  
CLI:
```bash
sari dry-run-diff --path core/db.py --content "$(cat /tmp/new_db.py)"
sari dry-run-diff --path core/db.py --content "$(cat /tmp/new_db.py)" --lint
```
ì„¤ëª…:
- ê¸°ë³¸ì€ êµ¬ë¬¸ ì²´í¬ë§Œ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- `--lint` ë˜ëŠ” `DECKARD_DRYRUN_LINT=1` ì„¤ì • ì‹œ, ì‚¬ìš© ê°€ëŠ¥í•œ ë¦°í„°(`ruff`/`eslint`)ê°€ ìˆìœ¼ë©´ ì‹¤í–‰í•©ë‹ˆë‹¤.

---

## ğŸ§° Composite Tool (grep_and_read)
MCP tool: `grep_and_read`  
ì„¤ëª…:
- ê²€ìƒ‰ ê²°ê³¼ ìƒìœ„ Nê°œ íŒŒì¼ì„ ì¦‰ì‹œ ì½ì–´ì˜µë‹ˆë‹¤.
- `search` â†’ `read_file` ë°˜ë³µì„ ì¤„ì´ê¸° ìœ„í•œ í† í°/í„´ ì ˆê° ë„êµ¬ì…ë‹ˆë‹¤.

ì˜ˆì‹œ:
```json
{ "name": "grep_and_read", "arguments": { "query": "process_file", "limit": 5, "read_limit": 2 } }
```

---

## ğŸ©º ì§„ë‹¨ (Doctor)

CLI:
```bash
sari doctor
sari doctor --auto-fix
sari doctor --auto-fix --auto-fix-rescan
```

ì„¤ëª…:
- `--auto-fix`ëŠ” ê°€ëŠ¥í•œ í•­ëª©ì— ëŒ€í•´ ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹œë„í•©ë‹ˆë‹¤.
- `--auto-fix-rescan`ì€ ìë™ ìˆ˜ì • ì´í›„ `scan_once`ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
  - ì§„í–‰ ìƒíƒœëŠ” `Auto Fix Rescan Start` / `Auto Fix Rescan` í•­ëª©ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.
  - ìë™ ìˆ˜ì •ì´ ì‹¤íŒ¨í•˜ë©´ `Auto Fix Rescan Skipped`ë¡œ í‘œì‹œë©ë‹ˆë‹¤.

---

## âœ… ì—£ì§€ í…ŒìŠ¤íŠ¸

```bash
scripts/run_edge_tests.sh
```

CI í¬í•¨:
```bash
scripts/run_tests_isolated.sh
```

## ğŸ”Œ Call-Graph í”ŒëŸ¬ê·¸ì¸ í—¬ìŠ¤ ì²´í¬

MCP tool: `call_graph_health`

---

## ğŸ” DB ë‹¨ì¼ Writer ì •ì±… (ì¤‘ìš”)

SariëŠ” SQLiteì˜ ë‹¨ì¼ writer ì›ì¹™ì„ **ê°•ì œ**í•©ë‹ˆë‹¤.

- **ì“°ê¸° ì‘ì—…ì€ DBWriter ì „ìš© ìŠ¤ë ˆë“œì—ì„œë§Œ ìˆ˜í–‰**ë©ë‹ˆë‹¤.
- ë‚´ë¶€ì—ì„œ ë³„ë„ writer ì»¤ë„¥ì…˜ì„ ìƒì„±í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ì§ì ‘ DB ì“°ê¸°ë¥¼ í˜¸ì¶œí•˜ë©´ `DB write attempted outside single-writer thread` ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¦‰, DB ì“°ê¸°ëŠ” **í•­ìƒ ì¸ë±ì„œ íŒŒì´í”„ë¼ì¸ì„ í†µí•´ì„œë§Œ** ìˆ˜í–‰ë˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.  
ì™¸ë¶€ í™•ì¥/ìŠ¤í¬ë¦½íŠ¸ì—ì„œ DBë¥¼ ì§ì ‘ ì“°ëŠ” ê²ƒì€ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

## ğŸ“œ ë¼ì´ì„ ìŠ¤ (License)

ì´ í”„ë¡œì íŠ¸ëŠ” [Apache License 2.0](LICENSE)ì„ ë”°ë¥´ê³  ìˆì–´ìš”. ëˆ„êµ¬ë‚˜ ììœ ë¡­ê²Œ ì‚¬ìš©í•˜ê³ , ê³ ì¹˜ê³ , ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ë°°í¬ ì‹œ `NOTICE` íŒŒì¼ì˜ ê³ ì§€ì‚¬í•­ë„ í•¨ê»˜ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.

---

**"ì, ì´ì œ ì‚¬ë¦¬ ì„ ìƒë‹˜ê³¼ í•¨ê»˜ ì—¬ëŸ¬ë¶„ì˜ ì½”ë“œ ì†ì— ìˆ¨ê²¨ì§„ ë¹„ë°€ì„ ì°¾ì•„ë³´ì‹œê² ë‚˜?"** ğŸ§™â€â™‚ï¸âœ¨
